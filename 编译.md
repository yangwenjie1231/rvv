# Auto Bind Python from C/C++

一个足够简单易用并且可配置的用于从 C/C++ 代码自动绑定为 Python 代码并生成 `.whl` 包的工程。

本项目克隆于：  
[https://github.com/Neutree/c_cpp_project_framework](https://github.com/Neutree/c_cpp_project_framework)  
并且编译代码部分与原仓库保持一致。

pybind11 自动绑定部分参考代码：  
[https://github.com/sipeed/MaixPy/tree/main/components/maix](https://github.com/sipeed/MaixPy/tree/main/components/maix)

---

## 快速上手

### 1. 克隆仓库并进入示例目录

```bash
git clone <本项目地址> --recursive
cd examples/demo
```

使用以下命令进入图形界面，配置编译工具链及是否打包为 `.whl` 文件：

```bash
python project.py menuconfig
```

- **x86**：本机编译  
- **arm64**：适用于 MaixCam2 编译  
- **RISCV64**：适用于 MaixCam / MaixCam Pro 编译  

---

### 2. 编写 C/C++ 函数及头文件

#### 示例函数（`add.cpp`）：
```cpp
namespace add::test
{
    int add(int a, int b) 
    {
        return a + b;
    }
}
```

#### 对应头文件（`add.hpp`）：
```cpp
namespace add::test
{
    /**
     * My function, add two integer.
     * @param a arg a, int type
     * @param b arg b, int type
     * @return int type, will a + b
     * @module add.test.add
     */
    int add(int a, int b);
}
```

> **说明**：
> - 第一行为函数简介；
> - `@param` 描述参数；
> - `@return` 描述返回值（可省略）；
> - `@module` 指定 Python 中的模块路径，格式为 `<包名>.<子模块>.<函数名>`。

---

### 3. 编译并打包

如果仅需编译并打包为 `.whl` 文件，则**无需修改 `main.cpp`**。

执行以下命令开始构建：

```bash
python project.py build
```

构建完成后，安装生成的 `.whl` 文件：

```bash
pip install build/*.whl
```

即可在 Python 中直接调用：

```python
import add
result = add.test.add(1, 1)
```

---

## 注意事项

- **一个头文件对应一个顶层模块名**。例如：
  - `add.hpp` → `import add`
  - 所有该头文件中声明的函数必须属于以 `add` 开头的命名空间（如 `add::xxx`）

- 若仅想生成绑定后的 C++ 文件（不编译），可直接运行：

  ```bash
  python cpp_bind_python.py
  ```

  添加 `--doc DOC` 参数可从注释自动生成文档：

  ```bash
  python cpp_bind_python.py --doc my_doc.md
  ```

--- 

> ✅ 通过上述流程，你可以快速将 C/C++ 函数封装为 Python 可调用的 `.whl` 包，适用于嵌入式 AI、高性能计算等场景。